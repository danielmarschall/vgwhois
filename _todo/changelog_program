#
#
# History:
# 2019-04-29  mar   Removed Debian package code. Distribution now via SVN!
#                   New directory structure strictly separates between gwhois itself ("main") and the maintenance programs ("maintenance")
# 2015-05-06  mar   pattern.d/* will now be preferred.
#                   Last resort (.) is now built-in.
#                   Fixed UTF-8 query input.
# 2014-08-18  mar   UTF-8 output is now unified.
# 2014-04-02  mar   Accepting "refer:" which IANA sends.
# 2013-12-17  mar   Added native OID support. Output will now contain a BOM if whois server did return a UTF-8 string.
# 2013-05-05  mar   *.dpkg-dist wird nun auch ausgeschlossen.
# 2012-05-22  mar   "::::" (multiple+notice) is now not splitted by ":::" pattern
#                   multiple+notice can now be combined. "notice" will output "Additional information" then.
# 2012-05-22  mar   Output of "cgihttps" and "program" is now anti spam filtered, too
# 2012-04-26  mar   "--" is now recognized as command line argument seperator
# 2012-04-25  mar   E-Mail addresses are now anti-spam protected! (Can be disabled with the CLI argument flag -e)
#                   This allows to add "RIPE -B" as default for public services.
# 2012-04-13  mar   Changed all &foo() into foo() .
#                   See: https://www.socialtext.net/perl5/subroutines_called_with_the_ampersand
# 2012-04-01  mar   New pattern available for recognizing ASN number ranges
#                   e.g. *AS:123-456 will match AS123, AS124 ... AS456
# 2012-03-04  mar   Bugfix for IPv6 recognization
# 2012-02-26  mar   IPv6 is now handled with Net::IP::ip_expand_address()
# 2012-01-28  mar   rwhois is now accepted as ReferralServer
#                   GWhoIs::Core::redirectwhois can handle different port than 43
# 2012-01-17  mar   quotemeta() to avoid shell injections
#			TODO: braucht man eigentlich nicht wegen der ursp. filterung
# 2012-01-10  mar   <pre> and <textarea> use now GWhoIs::Utils::htmlpre(). GWhoIs::Utils::render_html() optimized.
#                   Uses now STRICT perl code (used "my" everwhere and initialized variables)
#                   No warning at utf8 output, e.g. for cnnic.cn => UTF8 now possible.
# 2012-01-09  mar   Now recognizing "001.2.3.4" as "1.2.3.4" (IPv4 and IPv6)
# 2012-01-07  mar   Now supporting IPv6 subnetting / CIDR
# 2011-06-09  mar   Added "program" method which invokes a script.
#                   IPv4/6 detection: IPv6 needs at least one ":"
#                   -> e.g. "ac" can now be detected as TLD and not as IPv6 anymore.
#                   "To resolve one of the above handles" cannot be empty now.
# 2010-07-28  jule  Extend output from verisign-grs by last db update time
# 2010-05-15  jule  Add locale handling, use libidn for punycode
# 2008-10-19  jule  throw error on empty query string
# 2008-02-18  jule  added handling for .bi and .gh (never a shortage
#                   of nics wo need special handling)
# 2007-09-03  jule  made output from verisign-grs more verbose
# 2007-02-17  jule  added mechanism for modifying redirects (see readme.ripe)
# 2006-12-02  jule  new method multiple for doing multiple queries
# 2005-09-25  jule  replaced 'noipprefix' and 'ipprefix' by 'prefix'
# 2005-09-25  jule  query string is no longer forced lower case (Debian Bug#324669)
# 2005-01-15  jule  Added version output
# 2005-01-13  jule  Added "search" method 'notice' (for giving advice
#                   when no whois/lookup is available)
#                   Added "cgipostcurl" method which uses curl to
#                   fake a referer which is needed for the .nic.ar
#                   (i hate you!)
# 2005-01-06  jule  new routines for searching ipv4 addresses for more
#                   speed improvement
# 2005-01-03  jule  To get rid of the ERX tables which slow down everything,
#                   requery is now ok and will no longer send mails.
#                   (Debian Bug#243148)
#                   Added handling code for .pe (grr) (Debian Bug#264794)
# 2004-03-07  jule  Totally changed the ip address handling code, now uses
#                   CIDR blocks.
# 	            Recognized 'ipas a.b.c.d' as a request to ask team
#		    cymru ip->as mapper whois
# 2004-03-03  jule  Integrated smaller fixes and changes done by lutz.
#                   Removed special code for publicinterestregistry, as
#                   transition is over, and referrers are nolonger used.
#                   Changed handling code for generic whois, can now take
#                   some parameters, removing need for special cases.
# 2003-07-29  jule  fixed publicinterestregistry which is now in transition
#		    phase integrating the whois data
# 2003-02-15  jule  fixed handling of dpkg-old pattern versions
# 2003-01-27  jule  whois.publicinterestregistry.net is now authorative for
#                   .org and needs another special treatment... :-(
#                   plus some minor fixes
# 2003-01-02  f2u   Add "+" for IP address queries to ARIN whois.
#                   Support multiple pattern files.
# 2002-11-01  cord  Small workaround for whois-servers that return ^M.
# 2002-01-17  jule  Reporting if query to upstream whois server failed
#		    (Debian Bug#122535)
# 2000-12-08  jule  Braindead answers from nsiregistry excluded (NSI again!)
# 2000-06-29  lutz  Multiple whois queries (jule)
# 2000-02-29  lutz  Removed obsolete cgibr.
#             lutz  Fixed bug in IP queries.
# 2000-02-08  lutz  Braindead answers from nsiregistry excluded
#                   Workaround for bug@internic removed.
# 1999-12-01  jule  Support for new Internic two-step Whois
# 1999-08-04  lutz  Minor fixed
# 1999-07-01  lutz  Allowed spaces, commas and colons
# 1999-04-12  lutz  Hotfix for problems with LWP::Simple
# 1998-12-21  lutz  solving problems with ripe handles.
# 1998-12-18  lutz  Mirrors possible
#             jule  GWhoIs::Core::wwwsgrep with LWP::Simple
#             lutz  multiple options bug fixed
#             jule  whois access made with LWP::Simple
#             lutz  Cosmetic changes,
#                   Configurable,
#                   Dies without line numbers,
#                   Direct server access
#             jule  External Configuration File,
#                   Major rewrite
# 1998-12-17  lutz  Published due to jule
#
